/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 * Author:  admin
 * Created: 20-nov-2017

username: matteo
password: matteo
 */

CREATE TABLE utenti (
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR(32),
    cognome VARCHAR(32),
    dataNascita VARCHAR(10),
    motto VARCHAR(500),
    password VARCHAR(32) NOT NULL,
    urlImgProfilo VARCHAR(32),
    email VARCHAR(32) UNIQUE NOT NULL
    tipoUtente INTEGER NOT NULL,
    FOREIGN KEY (tipoUtente) REFERENCES tipiUtente(id)
);

CREATE TABLE tipiUtente (
    id  INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nomeTipo VARCHAR(5) UNIQUE NOT NULL
);

CREATE TABLE amici (
    idUtente1 INTEGER,
    idUtente2 INTEGER,
    PRIMARY KEY (idUtente1, idUtente2),
    FOREIGN KEY (idUtente1) REFERENCES utenti(id),
    FOREIGN KEY (idUtente2) REFERENCES utenti(id)
);

CREATE TABLE gruppi(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR(32)NOT NULL UNIQUE
);

CREATE TABLE iscrizioniGruppi (
    idUtente INTEGER,
    idGruppo INTEGER,
    PRIMARY KEY (idUtente, idGruppo),
    FOREIGN KEY (idUtente) REFERENCES utenti(id),
    FOREIGN KEY (idGruppo) REFERENCES gruppi(id)
);


CREATE TABLE post(
    id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    autorePost INTEGER,
    idUtenteDest INTEGER,
    idGruppoDest INTEGER,
    contenuto VARCHAR(500),
    linkAllegato VARCHAR(500),
    FOREIGN KEY (autorePost) REFERENCES utenti(id),
    FOREIGN KEY (idUtenteDest) REFERENCES utenti(id),
    FOREIGN KEY (idGruppoDest) REFERENCES gruppi(id)
);

